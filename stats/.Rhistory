model_comp <- bind_rows(
kids_model_pred %>%mutate(model = "RSA"),
prior_only_model_across%>%mutate(model = "Prior Only"),
no_prior_pred%>%select(-so_slope,-so_int,-speakerOptimality)%>%mutate(model = "No Prior")
)
pred_plot <- ggplot(model_comp_mean_ci)+
geom_line(data = model_comp,aes(age_bin, prop_informative, group = paste(iteration,Speaker,model, sep= ""), col = model),  alpha = 0.01) +
geom_ribbon(aes(x =age_bin, ymin = lci, ymax = uci, fill = model), alpha = .4) +
geom_line(aes(age_bin, mean, col = model), size = 1, alpha = 1) +
geom_hline(yintercept = 0.5, lty=2)+
labs(y="proportion more informative")+
scale_x_continuous(limits=c(0,2), name="age", breaks = c(0,0.5,1,1.5,2), labels = c(3.0,3.5,4.0,4.5,5)) +
ylim(-0.05,1.05)+
facet_grid(Speaker~Alignment)+
theme_few()+
scale_color_viridis_d()+
scale_fill_viridis_d()
pred_plot
pred_plot <- ggplot(model_comp_mean_ci)+
geom_line(data = model_comp,aes(age_bin, prop_informative, group = paste(iteration,Speaker,model, sep= ""), col = model),  alpha = 0.05) +
#geom_ribbon(aes(x =age_bin, ymin = lci, ymax = uci, fill = model), alpha = .4) +
geom_line(aes(age_bin, mean, col = model), size = 1, alpha = 1) +
geom_hline(yintercept = 0.5, lty=2)+
labs(y="proportion more informative")+
scale_x_continuous(limits=c(0,2), name="age", breaks = c(0,0.5,1,1.5,2), labels = c(3.0,3.5,4.0,4.5,5)) +
ylim(-0.05,1.05)+
facet_grid(Speaker~Alignment)+
theme_few()+
scale_color_viridis_d()+
scale_fill_viridis_d()
pred_plot
data <- ex3_data %>%
filter(trial != "filler1",
trial != "filler2")%>%
group_by(Speaker, Alignment ,subage) %>%
summarize(k = sum(correct_inf), n = n())%>%
ungroup() %>%
mutate(a = 1 + k,
b = 1 + n - k,
Data_ci_lower  = qbeta(.025, a, b),
Data_ci_upper = qbeta(.975, a, b),
Data = (a-1)/(a+b-2))%>%
select(-a,-b,-n,-k)
model <- kids_model_pred %>%
mutate(subage = ifelse(age_bin<1,"3","4"))%>%
group_by(model,Speaker,Alignment,subage)%>%
summarise(Model = mean(prop_informative),
Model_ci_lower = hdi_lower(prop_informative),
Model_ci_upper  =hdi_upper(prop_informative))
cor_plot <- model %>%
ungroup()%>%
mutate(Data = data$Data,
Data_ci_lower = data$Data_ci_lower,
Data_ci_upper  =data$Data_ci_upper)
ggplot(data = cor_plot,aes(x = Model, y = Data, col = subage)) +
geom_abline(intercept = 0, slope = 1, lty = 2, alpha = 1, size = .5)+
geom_point(size = 3)+
geom_errorbar(aes(ymin = Data_ci_lower, ymax = Data_ci_upper),width = 0,size = .5)+
geom_errorbarh(aes(xmin = Model_ci_lower, xmax = Model_ci_upper), height = 0,size = .5)+
coord_fixed()+
stat_cor(method = "pearson", label.x = 0.1, label.y = 0.9, aes(x = Model, y = Data), inherit.aes = F)+
facet_grid(~model)+
xlim(0,1)+ylim(0,1)+
xlab("Model")+
theme_few(base_size = 10) +
scale_colour_solarized()
cor.test(cor_plot$Model,cor_plot$Data)
kids_model_pred
model <- kids_model_pred_across %>%
mutate(subage = ifelse(age_bin<1,"3","4"))%>%
group_by(model,Speaker,Alignment,subage)%>%
summarise(Model = mean(prop_informative),
Model_ci_lower = hdi_lower(prop_informative),
Model_ci_upper  =hdi_upper(prop_informative))
model_pred_across
kids_model_pred <- model_pred_across%>%
select(value) %>%
map_df(bind_rows)%>%
mutate(iteration = rep(1:3400,each = 40))%>%
select(-diff_priorReg,-same_priorReg,-speakerOptimality,-so_slope,-so_int)%>%
gather(condition, prop_informative, -iteration,-age_bin)%>%
separate(condition, into = c("model", "Speaker", "Alignment"), sep="_")%>%
mutate(Speaker = ifelse(Speaker == "diff", "different_speaker","same_speaker"),
Alignment = ifelse(Alignment == "cong", "congruent","incongruent"))
plot_model_pred <- kids_model_pred %>%
group_by(model,age_bin,Speaker,Alignment)%>%
summarise(mean = mean(prop_informative),
lci = hdi_lower(prop_informative),
uci = hdi_upper(prop_informative))
p_data <- ex3_data %>%
filter(trial != "filler1",
trial != "filler2")%>%
mutate(age_bin = age_num - 3)%>%
group_by(Speaker, Alignment ,age_bin, subid)
ggplot(plot_model_pred)+
#geom_jitter(data = p_data, aes(x = age_bin, y = correct_inf), width = .025,height = .025, alpha = .2)+
geom_ribbon(aes(x =age_bin, ymin = lci, ymax = uci, fill = model), alpha = .4) +
geom_line(aes(age_bin, mean, col = model), size = 1, alpha = 1, linetype = 2) +
geom_smooth(data = p_data, aes(x = age_bin, y = correct_inf), col = "black", size = 0.6, method = "glm", method.args = list(family = "binomial"),  se = T,  alpha = .5, size = .4)+
#geom_hline(yintercept = 0.5, lty=2)+
labs(y="proportion more informative")+
scale_x_continuous(limits=c(0,2), name="age", breaks = c(0,0.5,1,1.5,2), labels = c(3.0,3.5,4.0,4.5,5)) +
ylim(-0.05,1.05)+
facet_grid(Speaker~Alignment)+
theme_few()+
scale_color_solarized()+
scale_fill_solarized()
data <- ex3_data %>%
filter(trial != "filler1",
trial != "filler2")%>%
group_by(Speaker, Alignment ,subage) %>%
summarize(k = sum(correct_inf), n = n())%>%
ungroup() %>%
mutate(a = 1 + k,
b = 1 + n - k,
Data_ci_lower  = qbeta(.025, a, b),
Data_ci_upper = qbeta(.975, a, b),
Data = (a-1)/(a+b-2))%>%
select(-a,-b,-n,-k)
model <- kids_model_pred %>%
mutate(subage = ifelse(age_bin<1,"3","4"))%>%
group_by(model,Speaker,Alignment,subage)%>%
summarise(Model = mean(prop_informative),
Model_ci_lower = hdi_lower(prop_informative),
Model_ci_upper  =hdi_upper(prop_informative))
cor_plot <- model %>%
ungroup()%>%
mutate(Data = data$Data,
Data_ci_lower = data$Data_ci_lower,
Data_ci_upper  =data$Data_ci_upper)
ggplot(data = cor_plot,aes(x = Model, y = Data, col = subage)) +
geom_abline(intercept = 0, slope = 1, lty = 2, alpha = 1, size = .5)+
geom_point(size = 3)+
geom_errorbar(aes(ymin = Data_ci_lower, ymax = Data_ci_upper),width = 0,size = .5)+
geom_errorbarh(aes(xmin = Model_ci_lower, xmax = Model_ci_upper), height = 0,size = .5)+
coord_fixed()+
stat_cor(method = "pearson", label.x = 0.1, label.y = 0.9, aes(x = Model, y = Data), inherit.aes = F)+
facet_grid(~model)+
xlim(0,1)+ylim(0,1)+
xlab("Model")+
theme_few(base_size = 10) +
scale_colour_solarized()
cor.test(cor_plot$Model,cor_plot$Data)
kids_model_pred
ggplot(model_comp_mean_ci)+
#geom_jitter(data = p_data, aes(x = age_bin, y = correct_inf), width = .025,height = .025, alpha = .2)+
geom_ribbon(aes(x =age_bin, ymin = lci, ymax = uci, fill = model), alpha = .4) +
geom_line(aes(age_bin, mean, col = model), size = 1, alpha = 1, linetype = 2) +
geom_smooth(data = p_data, aes(x = age_bin, y = correct_inf), col = "black", size = 0.6, method = "glm", method.args = list(family = "binomial"),  se = T,  alpha = .5, size = .4)+
#geom_hline(yintercept = 0.5, lty=2)+
labs(y="proportion more informative")+
scale_x_continuous(limits=c(0,2), name="age", breaks = c(0,0.5,1,1.5,2), labels = c(3.0,3.5,4.0,4.5,5)) +
ylim(-0.05,1.05)+
facet_grid(Speaker~Alignment)+
theme_few()+
scale_color_solarized()+
scale_fill_solarized()
pred_plot <- ggplot(model_comp_mean_ci)+
geom_line(data = model_comp,aes(age_bin, prop_informative, group = paste(iteration,Speaker,model, sep= ""), col = model),  alpha = 0.01) +
#geom_ribbon(aes(x =age_bin, ymin = lci, ymax = uci, fill = model), alpha = .4) +
geom_line(aes(age_bin, mean, col = model), size = 1, alpha = 1) +
geom_hline(yintercept = 0.5, lty=2)+
labs(y="proportion more informative")+
scale_x_continuous(limits=c(0,2), name="age", breaks = c(0,0.5,1,1.5,2), labels = c(3.0,3.5,4.0,4.5,5)) +
ylim(-0.05,1.05)+
facet_grid(Speaker~Alignment)+
theme_few()+
scale_color_viridis_d()+
scale_fill_viridis_d()
pred_plot
model <- model_comp %>%
mutate(subage = ifelse(age_bin<1,"3","4"))%>%
group_by(model,Speaker,Alignment,subage)%>%
summarise(Model = mean(prop_informative),
Model_ci_lower = hdi_lower(prop_informative),
Model_ci_upper  =hdi_upper(prop_informative))
cor_plot <- model %>%
ungroup()%>%
mutate(Data = rep(data$Data,3),
Data_ci_lower = rep(data$Data_ci_lower,3),
Data_ci_upper  =rep(data$Data_ci_upper,3))
ggplot(data = cor_plot,aes(x = Model, y = Data, col = subage)) +
geom_abline(intercept = 0, slope = 1, lty = 2, alpha = 1, size = .5)+
geom_point(size = 3)+
geom_errorbar(aes(ymin = Data_ci_lower, ymax = Data_ci_upper),width = 0,size = .5)+
geom_errorbarh(aes(xmin = Model_ci_lower, xmax = Model_ci_upper), height = 0,size = .5)+
coord_fixed()+
stat_cor(method = "pearson", label.x = 0.1, label.y = 0.9, aes(x = Model, y = Data), inherit.aes = F)+
facet_grid(~model)+
xlim(0,1)+ylim(0,1)+
xlab("Model")+
theme_few(base_size = 10) +
scale_colour_solarized()
knitr::include_graphics("../../papers/figures/kids_ex3_setup.png")
###
library(tidyverse)
library(knitr)
library(langcog)
library(ggthemes)
library(jsonlite)
library(readxl)
library(coda)
estimate_mode <- function(s) {
d <- density(s)
return(d$x[which.max(d$y)])
}
hdi_upper<- function(s){
m <- HPDinterval(mcmc(s))
return(m["var1","upper"])
}
hdi_lower<- function(s){
m <- HPDinterval(mcmc(s))
return(m["var1","lower"])
}
## importing data
files <- dir("~/Work/MCC/git-mcc/kids_EX3/pref/")
raw_data <- data_frame()
for (f in files) {
jf <- paste("~/Work/MCC/git-mcc/kids_EX3/pref/",f,sep="")
jd <- jsonlite::fromJSON(paste(readLines(jf), collapse=""))
date <- str_sub(jf,42,str_length(jf)-11)
id <- as_data_frame(jd$data$data) %>% mutate(test_date = date)
raw_data <- bind_rows(raw_data, id)
}
raw_data <- raw_data %>%
mutate(subid = ifelse(subid == "181128_3_ex3p....","181128_3_ex3p" , subid),
subid = ifelse(subid == "181128_1_ex3p.","181128_1_ex3p" , subid),
subid = ifelse(subid == " 181218_10_ex3p","181218_10_ex3p" , subid))
#unique(raw_data$subid)
log <- read_excel("../../../MCC-subject_log.xlsx", 1)%>%
filter(Condition == "ex3p")%>%
select(subid,experimenter,keep_drop,sex,dob)
#unique(log$subid)
sum(log$keep_drop == "drop")
d <- left_join(raw_data,log, by = "subid")%>%
filter(keep_drop == "keep")%>%
mutate(dob = as.numeric(dob),
dob = as.Date(dob,origin = "1899-12-30"),
age_num = lubridate::time_length(difftime(test_date,dob), "years"),
check_age = ifelse(substr(age_num,1,1) == subage, T, F))
library(lme4)
dm <- d %>%
filter(trial != "filler1",
trial != "filler2")%>%
mutate(age_num = scale(age_num, center = T, scale = T))
mex3 <- glmer(correct_inf ~ age_num*speaker*alignment
+ (speaker*alignment | subid)
+ (age_num*speaker*alignment | agent),
family = "binomial",
data = dm,
control=glmerControl(optimizer="bobyqa",optCtrl=list(maxfun=2e5)))
mex3 <- glmer(correct_inf ~ age_num*speaker*alignment
+ (speaker*alignment | subid)
+ (age_num*speaker*alignment | agent),
family = "binomial",
data = dm,
control=glmerControl(optimizer="bobyqa",optCtrl=list(maxfun=2e5)))
install.packages("MuMIn")
library(MuMIn)
r.squaredGLMM(mex3)
?r.squaredGLMM
r.squaredGLMM(mex3)
install.packages("r2glmm")
library(r2glmm)
r2beta(mex3)
?r2beta
r2beta(model = mex3, method = 'sgv', data = dm)
mex3 <- glmer(correct_inf ~ age_num*speaker*alignment
+ (1 | subid)
+ (1 | agent),
family = "binomial",
data = dm,
control=glmerControl(optimizer="bobyqa",optCtrl=list(maxfun=2e5)))
summary(mex3)
r2beta(model = mex3, method = 'sgv', data = dm)
mex3 <- glmer(correct_inf ~ age_num*speaker*alignment
+ (speaker+alignment | subid)
+ (age_num+speaker+alignment | agent),
family = "binomial",
data = dm,
control=glmerControl(optimizer="bobyqa",optCtrl=list(maxfun=2e5)))
mex3 <- glmer(correct_inf ~ age_num*speaker*alignment
+ (speaker+alignment | subid)
+ (speaker+alignment | agent),
family = "binomial",
data = dm,
control=glmerControl(optimizer="bobyqa",optCtrl=list(maxfun=2e5)))
summary(mex3)
summary(mex3)
r2beta(model = mex3, method = 'sgv', data = dm)
mex3 <- glmer(correct_inf ~ age_num*speaker*alignment
+ (speaker*alignment | subid)
+ (speaker*alignment | agent),
family = "binomial",
data = dm,
control=glmerControl(optimizer="bobyqa",optCtrl=list(maxfun=2e5)))
mex3 <- glmer(correct_inf ~ age_num*speaker*alignment
+ (speaker*alignment | subid)
+ (age_num*speaker*alignment | agent),
family = "binomial",
data = dm,
control=glmerControl(optimizer="bobyqa",optCtrl=list(maxfun=2e5)))
install.packages("piecewiseSEM")
rsquared(model = mex3, method = "delta")
library(piecewiseSEM)
rsquared(model = mex3, method = "delta")
summary(mex3)
?rsquared
rsquared(model = mex3, method = "theoretical")
.66^2
pred_plot <- ggplot(model_comp_mean_ci)+
geom_line(data = model_comp,aes(age_bin, prop_informative, group = paste(iteration,Speaker,model, sep= ""), col = model),  alpha = 0.01) +
geom_smooth(data = p_data, aes(x = age_bin, y = correct_inf), col = "black", size = 0.6, method = "glm", method.args = list(family = "binomial"),  se = T,  alpha = .5, size = .4)+
#geom_ribbon(aes(x =age_bin, ymin = lci, ymax = uci, fill = model), alpha = .4) +
geom_line(aes(age_bin, mean, col = model), size = 1, alpha = 1) +
geom_hline(yintercept = 0.5, lty=2)+
labs(y="proportion more informative")+
scale_x_continuous(limits=c(0,2), name="age", breaks = c(0,0.5,1,1.5,2), labels = c(3.0,3.5,4.0,4.5,5)) +
ylim(-0.05,1.05)+
facet_grid(Speaker~Alignment)+
theme_few()+
scale_color_viridis_d()+
scale_fill_viridis_d()
pred_plot
ggplot(model_comp_mean_ci)+
#geom_jitter(data = p_data, aes(x = age_bin, y = correct_inf), width = .025,height = .025, alpha = .2)+
geom_ribbon(aes(x =age_bin, ymin = lci, ymax = uci, fill = model), alpha = .4) +
geom_line(aes(age_bin, mean, col = model), size = 1, alpha = 1, linetype = 2) +
geom_smooth(data = p_data, aes(x = age_bin, y = correct_inf), col = "black", size = 0.6, method = "loess", method.args = list(family = "binomial"),  se = T,  alpha = .5, size = .4)+
#geom_hline(yintercept = 0.5, lty=2)+
labs(y="proportion more informative")+
scale_x_continuous(limits=c(0,2), name="age", breaks = c(0,0.5,1,1.5,2), labels = c(3.0,3.5,4.0,4.5,5)) +
ylim(-0.05,1.05)+
facet_grid(Speaker~Alignment)+
theme_few()+
scale_color_solarized()+
scale_fill_solarized()
ggplot(model_comp_mean_ci)+
#geom_jitter(data = p_data, aes(x = age_bin, y = correct_inf), width = .025,height = .025, alpha = .2)+
geom_ribbon(aes(x =age_bin, ymin = lci, ymax = uci, fill = model), alpha = .4) +
geom_line(aes(age_bin, mean, col = model), size = 1, alpha = 1, linetype = 2) +
geom_smooth(data = p_data, aes(x = age_bin, y = correct_inf), col = "black", size = 0.6, method = "loess",   se = T,  alpha = .5, size = .4)+
#geom_hline(yintercept = 0.5, lty=2)+
labs(y="proportion more informative")+
scale_x_continuous(limits=c(0,2), name="age", breaks = c(0,0.5,1,1.5,2), labels = c(3.0,3.5,4.0,4.5,5)) +
ylim(-0.05,1.05)+
facet_grid(Speaker~Alignment)+
theme_few()+
scale_color_solarized()+
scale_fill_solarized()
?geom_smooth
ggplot(model_comp_mean_ci)+
#geom_jitter(data = p_data, aes(x = age_bin, y = correct_inf), width = .025,height = .025, alpha = .2)+
geom_ribbon(aes(x =age_bin, ymin = lci, ymax = uci, fill = model), alpha = .4) +
geom_line(aes(age_bin, mean, col = model), size = 1, alpha = 1, linetype = 2) +
geom_smooth(data = p_data, aes(x = age_bin, y = correct_inf), col = "black", size = 0.6, method = "loess",   se = T,  alpha = .5, size = .4,span = 0.75,)+
#geom_hline(yintercept = 0.5, lty=2)+
labs(y="proportion more informative")+
scale_x_continuous(limits=c(0,2), name="age", breaks = c(0,0.5,1,1.5,2), labels = c(3.0,3.5,4.0,4.5,5)) +
ylim(-0.05,1.05)+
facet_grid(Speaker~Alignment)+
theme_few()+
scale_color_solarized()+
scale_fill_solarized()
ggplot(model_comp_mean_ci)+
#geom_jitter(data = p_data, aes(x = age_bin, y = correct_inf), width = .025,height = .025, alpha = .2)+
geom_ribbon(aes(x =age_bin, ymin = lci, ymax = uci, fill = model), alpha = .4) +
geom_line(aes(age_bin, mean, col = model), size = 1, alpha = 1, linetype = 2) +
geom_smooth(data = p_data, aes(x = age_bin, y = correct_inf), col = "black", size = 0.6, method = "loess",   se = T,  alpha = .5, size = .4,span = 0.1,)+
#geom_hline(yintercept = 0.5, lty=2)+
labs(y="proportion more informative")+
scale_x_continuous(limits=c(0,2), name="age", breaks = c(0,0.5,1,1.5,2), labels = c(3.0,3.5,4.0,4.5,5)) +
ylim(-0.05,1.05)+
facet_grid(Speaker~Alignment)+
theme_few()+
scale_color_solarized()+
scale_fill_solarized()
ggplot(model_comp_mean_ci)+
#geom_jitter(data = p_data, aes(x = age_bin, y = correct_inf), width = .025,height = .025, alpha = .2)+
geom_ribbon(aes(x =age_bin, ymin = lci, ymax = uci, fill = model), alpha = .4) +
geom_line(aes(age_bin, mean, col = model), size = 1, alpha = 1, linetype = 2) +
geom_smooth(data = p_data, aes(x = age_bin, y = correct_inf), col = "black", size = 0.6, method = "loess",   se = T,  alpha = .5, size = .4,span = 1)+
#geom_hline(yintercept = 0.5, lty=2)+
labs(y="proportion more informative")+
scale_x_continuous(limits=c(0,2), name="age", breaks = c(0,0.5,1,1.5,2), labels = c(3.0,3.5,4.0,4.5,5)) +
ylim(-0.05,1.05)+
facet_grid(Speaker~Alignment)+
theme_few()+
scale_color_solarized()+
scale_fill_solarized()
ggplot(model_comp_mean_ci)+
#geom_jitter(data = p_data, aes(x = age_bin, y = correct_inf), width = .025,height = .025, alpha = .2)+
geom_ribbon(aes(x =age_bin, ymin = lci, ymax = uci, fill = model), alpha = .4) +
geom_line(aes(age_bin, mean, col = model), size = 1, alpha = 1, linetype = 2) +
geom_smooth(data = p_data, aes(x = age_bin, y = correct_inf), col = "black", size = 0.6, method = "loess",   se = T,  alpha = .5, size = .4,span = 2)+
#geom_hline(yintercept = 0.5, lty=2)+
labs(y="proportion more informative")+
scale_x_continuous(limits=c(0,2), name="age", breaks = c(0,0.5,1,1.5,2), labels = c(3.0,3.5,4.0,4.5,5)) +
ylim(-0.05,1.05)+
facet_grid(Speaker~Alignment)+
theme_few()+
scale_color_solarized()+
scale_fill_solarized()
ggplot(model_comp_mean_ci)+
#geom_jitter(data = p_data, aes(x = age_bin, y = correct_inf), width = .025,height = .025, alpha = .2)+
geom_ribbon(aes(x =age_bin, ymin = lci, ymax = uci, fill = model), alpha = .4) +
geom_line(aes(age_bin, mean, col = model), size = 1, alpha = 1, linetype = 2) +
geom_smooth(data = p_data, aes(x = age_bin, y = correct_inf), col = "black", size = 0.6, method = "loess",   se = T,  alpha = .5, size = .4,span = 3)+
#geom_hline(yintercept = 0.5, lty=2)+
labs(y="proportion more informative")+
scale_x_continuous(limits=c(0,2), name="age", breaks = c(0,0.5,1,1.5,2), labels = c(3.0,3.5,4.0,4.5,5)) +
ylim(-0.05,1.05)+
facet_grid(Speaker~Alignment)+
theme_few()+
scale_color_solarized()+
scale_fill_solarized()
ggplot(model_comp_mean_ci)+
#geom_jitter(data = p_data, aes(x = age_bin, y = correct_inf), width = .025,height = .025, alpha = .2)+
geom_ribbon(aes(x =age_bin, ymin = lci, ymax = uci, fill = model), alpha = .4) +
geom_line(aes(age_bin, mean, col = model), size = 1, alpha = 1, linetype = 2) +
geom_smooth(data = p_data, aes(x = age_bin, y = correct_inf), col = "black", size = 0.6, method = "loess",   se = T,  alpha = .5, size = .4,span = 5)+
#geom_hline(yintercept = 0.5, lty=2)+
labs(y="proportion more informative")+
scale_x_continuous(limits=c(0,2), name="age", breaks = c(0,0.5,1,1.5,2), labels = c(3.0,3.5,4.0,4.5,5)) +
ylim(-0.05,1.05)+
facet_grid(Speaker~Alignment)+
theme_few()+
scale_color_solarized()+
scale_fill_solarized()
ggplot(model_comp_mean_ci)+
#geom_jitter(data = p_data, aes(x = age_bin, y = correct_inf), width = .025,height = .025, alpha = .2)+
geom_ribbon(aes(x =age_bin, ymin = lci, ymax = uci, fill = model), alpha = .4) +
geom_line(aes(age_bin, mean, col = model), size = 1, alpha = 1, linetype = 2) +
geom_smooth(data = p_data, aes(x = age_bin, y = correct_inf), col = "black", size = 0.6, method = "loess",   se = T,  alpha = .5, size = .4,span = 0.75)+
#geom_hline(yintercept = 0.5, lty=2)+
labs(y="proportion more informative")+
scale_x_continuous(limits=c(0,2), name="age", breaks = c(0,0.5,1,1.5,2), labels = c(3.0,3.5,4.0,4.5,5)) +
ylim(-0.05,1.05)+
facet_grid(Speaker~Alignment)+
theme_few()+
scale_color_solarized()+
scale_fill_solarized()
method.args = list(family = "binomial"),
ggplot(model_comp_mean_ci)+
#geom_jitter(data = p_data, aes(x = age_bin, y = correct_inf), width = .025,height = .025, alpha = .2)+
geom_ribbon(aes(x =age_bin, ymin = lci, ymax = uci, fill = model), alpha = .4) +
geom_line(aes(age_bin, mean, col = model), size = 1, alpha = 1, linetype = 2) +
geom_smooth(data = p_data, aes(x = age_bin, y = correct_inf), col = "black", size = 0.6, method = "loess", method.args = list(family = "binomial"),  se = T,  alpha = .5, size = .4)+
#geom_hline(yintercept = 0.5, lty=2)+
labs(y="proportion more informative")+
scale_x_continuous(limits=c(0,2), name="age", breaks = c(0,0.5,1,1.5,2), labels = c(3.0,3.5,4.0,4.5,5)) +
ylim(-0.05,1.05)+
facet_grid(Speaker~Alignment)+
theme_few()+
scale_color_solarized()+
scale_fill_solarized()
pred_plot <- ggplot(model_comp_mean_ci)+
geom_line(data = model_comp,aes(age_bin, prop_informative, group = paste(iteration,Speaker,model, sep= ""), col = model),  alpha = 0.02) +
geom_smooth(data = p_data, aes(x = age_bin, y = correct_inf), col = "black", size = 0.6, method = "glm", method.args = list(family = "binomial"),  se = T,  alpha = .5, size = .4)+
#geom_ribbon(aes(x =age_bin, ymin = lci, ymax = uci, fill = model), alpha = .4) +
geom_line(aes(age_bin, mean, col = model), size = 1, alpha = 1) +
geom_hline(yintercept = 0.5, lty=2)+
labs(y="proportion more informative")+
scale_x_continuous(limits=c(0,2), name="age", breaks = c(0,0.5,1,1.5,2), labels = c(3.0,3.5,4.0,4.5,5)) +
ylim(-0.05,1.05)+
facet_grid(Speaker~Alignment)+
theme_few()+
scale_color_solarized()+
scale_fill_solarized()
pred_plot
pred_plot <- ggplot(model_comp_mean_ci)+
geom_hline(yintercept = 0.5, lty=2)+
geom_line(data = model_comp,aes(age_bin, prop_informative, group = paste(iteration,Speaker,model, sep= ""), col = model),  alpha = 0.02) +
#geom_ribbon(aes(x =age_bin, ymin = lci, ymax = uci, fill = model), alpha = .4) +
geom_line(aes(age_bin, mean, col = model), size = 1, alpha = 1) +
geom_smooth(data = p_data, aes(x = age_bin, y = correct_inf), col = "black", size = 0.6, method = "glm", method.args = list(family = "binomial"),  se = T,  alpha = .5, size = .4)+
labs(y="proportion more informative")+
scale_x_continuous(limits=c(0,2), name="age", breaks = c(0,0.5,1,1.5,2), labels = c(3.0,3.5,4.0,4.5,5)) +
ylim(-0.05,1.05)+
facet_grid(Speaker~Alignment)+
theme_few()+
scale_color_solarized()+
scale_fill_solarized()
pred_plot
pred_plot <- ggplot(model_comp_mean_ci)+
geom_hline(yintercept = 0.5, lty=2)+
geom_line(data = model_comp,aes(age_bin, prop_informative, group = paste(iteration,Speaker,model, sep= ""), col = model),  alpha = 0.05) +
#geom_ribbon(aes(x =age_bin, ymin = lci, ymax = uci, fill = model), alpha = .4) +
geom_line(aes(age_bin, mean, col = model), size = 1, alpha = 1) +
geom_smooth(data = p_data, aes(x = age_bin, y = correct_inf), col = "black", size = 0.6, method = "glm", method.args = list(family = "binomial"),  se = T,  alpha = .5, size = .4)+
labs(y="proportion more informative")+
scale_x_continuous(limits=c(0,2), name="age", breaks = c(0,0.5,1,1.5,2), labels = c(3.0,3.5,4.0,4.5,5)) +
ylim(-0.05,1.05)+
facet_grid(Speaker~Alignment)+
theme_few()+
scale_color_solarized()+
scale_fill_solarized()
pred_plot
pred_plot <- ggplot(model_comp_mean_ci)+
geom_hline(yintercept = 0.5, lty=2)+
geom_line(data = model_comp,aes(age_bin, prop_informative, group = paste(iteration,Speaker,model, sep= ""), col = model),  alpha = 0.05) +
#geom_ribbon(aes(x =age_bin, ymin = lci, ymax = uci, fill = model), alpha = .4) +
geom_line(aes(age_bin, mean, col = model), size = 1, alpha = 1) +
geom_smooth(data = p_data, aes(x = age_bin, y = correct_inf), col = "black", size = 0.6, method = "glm", method.args = list(family = "binomial"),  se = T,  alpha = .5, size = .4)+
labs(y="proportion more informative")+
scale_x_continuous(limits=c(0,2), name="age", breaks = c(0,0.5,1,1.5,2), labels = c(3.0,3.5,4.0,4.5,5)) +
ylim(-0.05,1.05)+
facet_grid(Speaker~Alignment)+
theme_few()+
scale_color_colorblind()+
scale_fill_colorblind()
pred_plot
